<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>whisper-scratchpad</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
</head>
<body>
<div id="kohDiv" class="clearfix">
<h1>whisper-scratchpad</h1>

<div style="width:90%; height: 10cm">
  <textarea id="editorTextarea" wrap="soft"
    placeholder="Editor, recording inserted at cursor. Full editor copied to clipboard after each recording."
    style="width:100%;height: 100%;"></textarea>
</div>

<div class="button-container" style="margin-top: 5mm">
  <span><button id="recordButton">â¬¤ Record</button>
    <span class="spinner" style="display: none;"></span>
  </span>
  <button id="pauseButton">â€– Pause</button>
  <button id="saveEditorButton">
    <span class="makeGreen">ðŸ’¾</span>
    Save editor</button>
  <button id="copyButton">âŽ˜ Copy to clipboard</button>
  <button id="clearButton"><span class="makeGreen">ðŸ§¹</span> Clear</button>
  <button id="downloadButton" style="display:none;">Download</button>
</div>
<div style="width:100%">
  <br>The text of each recording is inserted at the cursor position.
  <br>
  <br>I made this simple page to use the revolution in speech recognition: OpenAI Whisper. The voice recognition on your phone is a joke compared with whisper-large.
  <br>
  <br>The API key is only stored in a cookie locally on your computer. You don't have to trust me on that, you can download this to your computer and run it there and check (and improve :) ) the very simple code. Also, you can set a limit to your costs in the OpenAI dashboard. Btw: Whisper is dirt cheap: $0.036 / hour (rounded to the nearest second).
  <br>
  <br>This can be installed as an App, tested on Android and Windows, probably on other OSes as well ("PWA"). <a href="https://www.google.com/search?client=opera&q=how+to+install+a+web+page+as+an+app&sourceid=opera&ie=UTF-8&oe=UTF-8">How-Tos here</a>
  <br>
  <br><input type="text" id="apiKey" placeholder="Enter OpenAI API Key">
  <button id="saveAPIKeyButton">
    <span class="makeGreen">ðŸ’¾</span>
    Save API Key</button>
  <br>
  <br><a href="https://platform.openai.com/api-keys">Click here to get an API key</a>.

  If you want to try it out beforehand, you can try it in the ChatGPT Android and iOS apps for free without API key.
</div>

  <h3>Optional</h3>

  <!--############## whisperPrompt ##############-->
  <div style="width:90%;">
    <label for="whisperPrompt">Prompt: <span id="whisperPromptInfoIcon">â“˜</span>
      <span id="whisperPromptInfoText" class="hidden">
        Since it wasn't trained using instruction-following techniques, Whisper operates more like a base GPT model. It's important to keep in mind that Whisper only considers the first 244 tokens of the prompt. <a href="https://platform.openai.com/docs/guides/speech-to-text/prompting">More info</a>
      </span>
    </label>
    <div style="height: 10cm;">
      <textarea id="whisperPrompt" wrap="soft" placeholder="Optional prompt especially for hinting unusual names if they are not recognized by default." style="width:100%;height: 100%;"></textarea>
    </div>
    <button id="savePromptButton" style="margin-top: 5mm">
      <span class="makeGreen">ðŸ’¾</span>
      Save prompt
    </button>
  </div>

  <!--############## replaceRules ##############-->
  <div style="width:90%;">
    <label for="replaceRulesTextArea">Replacement rules:
      <span id="replaceRulesInfoIcon">â“˜</span>
      <span id="replaceRulesInfoText" class="hidden">
        <br>A ruleset contains one or more rule, the format looks like:
        <br>:: Any "SEARCH" becomes "REPLACE"
        <br>"SEARCH"->"REPLACE" <a href="https://github.com/No3371/obsidian-regex-pipeline">More info</a>
        <br>I like this:
        <br>:: ### English ###
        <br>"comma"->","
        <br>"full stop"->","
        <br>"colon"->":"
        <br>"dash"->"-"
        <br>:: ### German ###
        <br>"Komma"->","
        <br>"Punkt"->","
        <br>"Doppelpunkt"->":"
        <br>"Bindestrich"->"-"
        <br>"Semikolon"->";"
        <br>"Klammer auf"->"("
        <br>"Klammer zu"->")"
      </span>
    </label>
    <div style="height: 10cm;">
      <textarea id="replaceRulesTextArea" wrap="soft" placeholder="Optional. &quot;SEARCH&quot;-&gt;&quot;REPLACE&quot;" style="width:100%;height: 100%;"></textarea>
    </div>
    <button id="saveRulesButton" style="margin-top: 5mm">
      <span class="makeGreen">ðŸ’¾</span>
      Save rules
    </button>
  </div>

<div style="width:100%;" >
    <h3 style="margin-bottom: -15px">For devs</h3>
    <br>- <a href="https://platform.openai.com/docs/api-reference/audio/createTranscription">API docs</a>
    <br>- <a href="https://platform.openai.com/docs/guides/speech-to-text">OpenAI Speech Guide</a>
    <br>- Once my browser said the page wanted to read the clipboard... if you get that just deny it. The page does not actually want to read the clipboard, I wrote no code for that.
    <br>
    <br>Copyright 2023 by <a href="https://twitter.com/silidev">https://twitter.com/silidev</a>. V1.05. GPL V3.
  </div>
</div>
<script src="script.js"></script>
</body>
</html>
